<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BD Clan Clicker Minigame</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
   <style>
        /* Animation classes */
        @keyframes hit {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes death {
            0% { opacity: 1; transform: scale(1) rotate(0deg); }
            100% { opacity: 0; transform: scale(0) rotate(360deg); }
        }
        
        @keyframes respawn {
            0% { opacity: 0; transform: scale(0) rotate(-360deg); }
            100% { opacity: 1; transform: scale(1) rotate(0deg); }
        }
        
        .hit-animation {
            animation: hit 0.3s ease;
        }
        
        .death-animation {
            animation: death 0.5s ease forwards;
        }
        
        .respawn-animation {
            animation: respawn 0.5s ease forwards;
        }
        
        /* Custom styles */
        .demon-theme {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }
        
        .demon-text {
            color: #ff4d4d;
        }
        
        .demon-card {
            background-color: #16213e;
            border-left: 4px solid #ff4d4d;
        }
        
        .demon-btn {
            background-color: #ff4d4d;
            color: white;
        }
        
        .demon-btn:hover {
            background-color: #ff1a1a;
        }
        
        .target {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .target:hover {
            transform: scale(1.05);
        }
        
        .progress-bar {
            height: 20px;
            background-color: #1a1a2e;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4d4d, #ff1a1a);
            transition: width 0.3s ease;
        }
        
        .kill-count {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff4d4d;
            text-shadow: 0 0 5px rgba(255, 0, 0, 0.5);
        }
        
        .stats-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .stats-table th, .stats-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #2d3748;
        }
        
        .stats-table th {
            background-color: #1a1a2e;
            color: #ff4d4d;
        }
        
        .stats-table tr:hover {
            background-color: #2d3748;
        }
    </style>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body class="demon-theme min-h-screen p-4">
  <!-- Navigation Bar -->
  <nav>
    <h1>BD Clan Minigame</h1>
  </nav>

  <!-- Filters and Killer Selector -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
    <div>
      <label for="level-filter" class="block mb-1 font-semibold">Filter by Level:</label>
      <select id="level-filter" class="text-black p-2 rounded w-full">
        <option value="all">All Levels</option>
      </select>
    </div>
    <div>
      <label for="sort-method" class="block mb-1 font-semibold">Sort:</label>
      <select id="sort-method" class="text-black p-2 rounded w-full">
        <option value="default">Sort: Default</option>
        <option value="level-asc">Sort: Level (Low → High)</option>
        <option value="level-desc">Sort: Level (High → Low)</option>
        <option value="name-asc">Sort: Name (A → Z)</option>
      </select>
    </div>
    <div>
      <label for="killer-select" class="block mb-1 font-semibold">Select Killer:</label>
      <select id="killer-select" class="text-black p-2 rounded w-full">
        <option value="" disabled selected>Loading...</option>
      </select>
    </div>
  </div>

  <!-- Clicker Minigame Targets -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
    <div id="zen-target" class="target-box">
      <h2 class="text-xl font-bold mb-2">Zen</h2>
      <div class="health-bar mb-2">
        <div id="zen-health" class="health-fill"></div>
      </div>
      <button onclick="attack('Zen')" class="bg-red-600 px-3 py-1 rounded hover:bg-red-700">Attack</button>
    </div>
    <div id="kyle-target" class="target-box">
      <h2 class="text-xl font-bold mb-2">Kyle</h2>
      <div class="health-bar mb-2">
        <div id="kyle-health" class="health-fill"></div>
      </div>
      <button onclick="attack('Kyle')" class="bg-red-600 px-3 py-1 rounded hover:bg-red-700">Attack</button>
    </div>
    <div id="levi-target" class="target-box">
      <h2 class="text-xl font-bold mb-2">Levi</h2>
      <div class="health-bar mb-2">
        <div id="levi-health" class="health-fill"></div>
      </div>
      <button onclick="attack('Levi')" class="bg-red-600 px-3 py-1 rounded hover:bg-red-700">Attack</button>
    </div>
    <div id="ban-target" class="target-box">
      <h2 class="text-xl font-bold mb-2">Ban</h2>
      <div class="health-bar mb-2">
        <div id="ban-health" class="health-fill"></div>
      </div>
      <button onclick="attack('Ban')" class="bg-red-600 px-3 py-1 rounded hover:bg-red-700">Attack</button>
    </div>
  </div>

  <!-- Stats Section -->
  <div class="mb-6">
    <h2 class="text-lg font-bold mb-2">Stats</h2>
    <p>Total Kills: <span id="total-kills">0</span></p>
    <p>Zen Kills: <span id="zen-kills">0</span></p>
    <p>Kyle Kills: <span id="kyle-kills">0</span></p>
    <p>Levi Kills: <span id="levi-kills">0</span></p>
    <p>Ban Kills: <span id="ban-kills">0</span></p>
  </div>

  <!-- Kill Details Table -->
  <div class="overflow-x-auto mb-6">
    <table class="min-w-full table-auto border border-white">
      <thead>
        <tr class="bg-gray-800">
          <th class="px-4 py-2">Killer</th>
          <th class="px-4 py-2">Victim</th>
          <th class="px-4 py-2">Count</th>
        </tr>
      </thead>
      <tbody id="kill-details"></tbody>
    </table>
  </div>

  <button id="export-members" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded mb-4 hidden">
    Export Members List
  </button>
    <script>
  // Firebase config
  const firebaseConfig = {
    databaseURL: "https://aoh-bd-clan-default-rtdb.firebaseio.com/"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const levelFilter = document.getElementById("level-filter");
  const sortMethod = document.getElementById("sort-method");
  const killerSelect = document.getElementById("killer-select");
  const killDetails = document.getElementById("kill-details");

  const healthBars = {
    Zen: { bar: document.getElementById("zen-health"), count: 100, kills: 0, display: document.getElementById("zen-kills") },
    Kyle: { bar: document.getElementById("kyle-health"), count: 100, kills: 0, display: document.getElementById("kyle-kills") },
    Levi: { bar: document.getElementById("levi-health"), count: 100, kills: 0, display: document.getElementById("levi-kills") },
    Ban: { bar: document.getElementById("ban-health"), count: 100, kills: 0, display: document.getElementById("ban-kills") }
  };
  let totalKills = 0;
  const totalKillsDisplay = document.getElementById("total-kills");
  const killLog = [];

  function updateHealthDisplay(name) {
    const bar = healthBars[name].bar;
    const health = healthBars[name].count;
    bar.style.width = `${health}%`;
    bar.style.background = `linear-gradient(90deg, #ff4d4d, #ff1a1a)`;
    bar.style.height = "20px";
  }

  function attack(name) {
    if (!healthBars[name]) return;
    healthBars[name].count -= 10;
    if (healthBars[name].count <= 0) {
      healthBars[name].kills++;
      totalKills++;
      const killer = killerSelect.value || "Unknown";
      killLog.push({ killer, victim: name });

      updateKillStats();
      updateKillDetailsTable();
      healthBars[name].count = 100; // reset health
    }
    updateHealthDisplay(name);
  }

  function updateKillStats() {
    totalKillsDisplay.textContent = totalKills;
    Object.entries(healthBars).forEach(([name, data]) => {
      data.display.textContent = data.kills;
    });
  }

  function updateKillDetailsTable() {
    killDetails.innerHTML = "";
    killLog.forEach(log => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td class="border px-4 py-2">${log.killer}</td>
        <td class="border px-4 py-2">${log.victim}</td>
        <td class="border px-4 py-2">1</td>
      `;
      killDetails.appendChild(row);
    });
  }

  function populateFiltersAndDropdowns(members) {
    // Filter ranges
    const levelRanges = Array.from({ length: 20 }, (_, i) => [i * 1000, (i + 1) * 1000]);
    levelFilter.innerHTML = `<option value="all">All Levels</option>`;
    levelRanges.forEach(([min, max]) => {
      levelFilter.innerHTML += `<option value="${min}-${max}">${min}-${max}</option>`;
    });

    killerSelect.innerHTML = `<option value="" disabled selected>Select Killer</option>`;
    members.forEach(member => {
      killerSelect.innerHTML += `<option value="${member.username}">${member.username}</option>`;
    });
  }

  function renderMemberList(filtered) {
    // For debugging: console.log(filtered);
    // You could also render this to an HTML element if needed
  }

  function applyFiltersAndSort(members) {
    const filterValue = levelFilter.value;
    const sortValue = sortMethod.value;

    let filtered = [...members];

    if (filterValue !== "all") {
      const [min, max] = filterValue.split("-").map(Number);
      filtered = filtered.filter(m => m.level >= min && m.level < max);
    }

    if (sortValue === "level-asc") {
      filtered.sort((a, b) => a.level - b.level);
    } else if (sortValue === "level-desc") {
      filtered.sort((a, b) => b.level - a.level);
    } else if (sortValue === "name-asc") {
      filtered.sort((a, b) => a.username.localeCompare(b.username));
    }

    renderMemberList(filtered);
  }

  function fetchMembers() {
    db.ref("clanData/members").once("value", snapshot => {
      const members = snapshot.val() || [];
      populateFiltersAndDropdowns(members);
      applyFiltersAndSort(members);
    });
  }

  levelFilter.addEventListener("change", fetchMembers);
  sortMethod.addEventListener("change", fetchMembers);

  // Init
  Object.keys(healthBars).forEach(updateHealthDisplay);
  fetchMembers();
</script>

</body>
</html>
